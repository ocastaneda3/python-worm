<!-- PROJECT SHIELDS -->
[![Contributors][contributors-shield]][contributors-url]
[![Forks][forks-shield]][forks-url]
[![Stargazers][stars-shield]][stars-url]
[![LinkedIn][linkedin-shield]][linkedin-url]

<!-- TABLE OF CONTENTS -->
## Table of Contents
<ol>
	<li><a href="#about-the-project">About The Project</a>
		<ul>
			<li><a href="#built-with">Built With</a></li>
		</ul>
	</li>
	<li><a href="#getting-started">Getting Started</a>
		<ul>
			<li><a href="#prerequisites">Prerequisites</a>
				<ul>
					<li><a href="#gns3">GNS3</a></li>
				</ul>
				<ul>
					<li><a href="#virtual-box">Virtual Box</a></li>
				</ul>
			</li>
			<li><a href="#installation">Installation</a></li>
		</ul>
	</li>
	<li><a href="#usage">Usage</a></li>
	<li><a href="#contact">Contact</a></li>
</ol>

<!-- ABOUT THE PROJECT -->
## About The Project

![Single Network][single-network]

This program is a python worm that I developed in Network Security course as a final course project. Using GNS3 to create a safe network to test on, `worm.py` is copied into one of the three Lubuntu Virtual Machines (VM) as the host system. From there it will execute and start infecting the other machines on the network using a SSH dictionary attack. 

When `worm.py` is executed it iterates through a list of avaliable hosts to infect which is generated by using a nmap command to look for other systems with default open SSH ports (port 22). When a valid attempt connecting to another system is found then `worm.py` will copy itself to that machine, modify itself to be a executable, and then send an execute command to start the same process as before but now on the newly infected system. Once all valid systems are infected, the process of infecting is finished.

![Multi Network][multi-network]

As an additional challenge, the `worm.py` program is able to spread onto other networks so long that there is a machine using multiple network interfaces. This is done by `worm.py` iterating through the avaliable interfaces not including the loopback interface. If more than one interface is found then the spead and execute will occur twice, once on each avaliable network interfaces.

### Built With

* [Python 2.0](https://www.python.org/download/releases/2.0/)
* [GNS3](https://www.gns3.com/)
* [VirtualBox 6.0.24](https://www.virtualbox.org/wiki/Download_Old_Builds_6_0)


<!-- GETTING STARTED -->
## Getting Started

To see just how this worm is able to propagate through a network follow appropriate steps to install GNS3 on the OS of your choice to get started.

### Prerequisites

First, we need to create an isolated network to safely test the wormâ€™s ability to spread and execute. For this we can use GNS3 which is a network emulator which allows the combination of virtual and real devices to simulate simple and complex networks. Even though for this project the use of routers is not necessary but GNS3 uses Dynamips emulation software to simulate Cisco IOS routers as well.

#### GNS3
<p align="center">
	<img src="https://github.com/ocastaneda3/python-worm/blob/main/images/gns3_windows.png">
</p>

<ul>
	<li><a href="https://github.com/GNS3/gns3-gui/releases/tag/v2.2.17"><strong>GNS3 2.2.17</a></strong>
		<ul>
			<li><a href="https://docs.gns3.com/docs/getting-started/installation/windows"><span>&nbsp;</span>Windows Version 2.2.17</a></li>
			<li><a href="https://docs.gns3.com/docs/getting-started/installation/mac"><span>&nbsp;</span>Mac Version 2.2.17</a></li>
			<li><a href="https://docs.gns3.com/docs/getting-started/installation/linux"><span>&nbsp;</span>Linux Version 2.2.17</a></li>
		</ul>
	</li>
</ul>

Second, we need to have a way to create temporary systems that can be compromised by this simple worm. For this I used Virtual Box to create some virtual machines to play with. Following the `Prerequisites` section, I provide a way to obtain the OVA files for the virtual machines I used for this project. Please see step 2 of the `Installation` section

#### Virtual Box

<p align="center">
	<img src="https://linuxsecurityblog.files.wordpress.com/2019/11/gns3import.png">
</p>

<ul>
	<li><strong><a href="https://gns3.com/software/download">VirtualBox 6.0.24</a></strong> <em>(released July 14 2020)</em>
		<ul>
			<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/VirtualBox-6.0.24-139119-Win.exe"><span>&nbsp;</span>Windows hosts</a></li>
			<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/VirtualBox-6.0.24-139119-OSX.dmg"><span>&nbsp;</span>OS X hosts</a></li>
			<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/VirtualBox-6.0.24-139119-SunOS.tar.gz"><span>&nbsp;</span>Solaris hosts</a></li>
			<li>Linux Hosts:
				<ul>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/VirtualBox-6.0-6.0.24_139119_el8-1.x86_64.rpm"><span>&nbsp;</span>Oracle Linux 8 / Red Hat Enterprise Linux 8 / CentOS 8</a></li>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/VirtualBox-6.0-6.0.24_139119_el7-1.x86_64.rpm"><span>&nbsp;</span>Oracle Linux 7 / Red Hat Enterprise Linux 7 / CentOS 7</a></li>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/VirtualBox-6.0-6.0.24_139119_el6-1.x86_64.rpm"><span>&nbsp;</span>Oracle Linux 6 / Red Hat Enterprise Linux 6 / CentOS 6</a></li>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/virtualbox-6.0_6.0.24-139119~Ubuntu~eoan_amd64.deb"><span>&nbsp;</span>Ubuntu 19.10 / 20.04</a></li>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/virtualbox-6.0_6.0.24-139119~Ubuntu~bionic_amd64.deb"><span>&nbsp;</span>Ubuntu 18.04 / 18.10 / 19.04</a></li>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/virtualbox-6.0_6.0.24-139119~Ubuntu~xenial_amd64.deb"><span>&nbsp;</span>Ubuntu 16.04</a></li>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/virtualbox-6.0_6.0.24-139119~Ubuntu~trusty_amd64.deb"><span>&nbsp;</span>Ubuntu 14.04 / 14.10 / 15.04</a></li>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/virtualbox-6.0_6.0.24-139119~Debian~buster_amd64.deb"><span>&nbsp;</span>Debian 10</a></li>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/virtualbox-6.0_6.0.24-139119~Debian~stretch_amd64.deb"><span>&nbsp;</span>Debian 9</a></li>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/virtualbox-6.0_6.0.24-139119~Debian~jessie_amd64.deb"><span>&nbsp;</span>Debian 8</a></li>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/VirtualBox-6.0-6.0.24_139119_openSUSE150-1.x86_64.rpm"><span>&nbsp;</span>openSUSE 15.0</a></li>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/VirtualBox-6.0-6.0.24_139119_openSUSE132-1.x86_64.rpm"><span>&nbsp;</span>openSUSE 13.2 / Leap 42</a></li>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/VirtualBox-6.0-6.0.24_139119_fedora31-1.x86_64.rpm"><span>&nbsp;</span>Fedora 31</a></li>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/VirtualBox-6.0-6.0.24_139119_fedora29-1.x86_64.rpm"><span>&nbsp;</span>Fedora 29 / 30</a></li>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/VirtualBox-6.0-6.0.24_139119_fedora26-1.x86_64.rpm"><span>&nbsp;</span>Fedora 26 / 27 / 28</a></li>
					<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/VirtualBox-6.0.24-139119-Linux_amd64.run"><span>&nbsp;</span>All distributions</a></li>
				</ul>
			</li>
			<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/Oracle_VM_VirtualBox_Extension_Pack-6.0.24.vbox-extpack"><span>&nbsp;</span>Extension Pack</a></li>
			<li><a href="https://download.virtualbox.org/virtualbox/6.0.24/VirtualBox-6.0.24.tar.bz2"><span>&nbsp;</span>Sources</a></li>
			<li><a href="https://www.virtualbox.org/download/hashes/6.0.24/MD5SUMS">MD5 checksums</a>, <a href="https://www.virtualbox.org/download/hashes/6.0.24/SHA256SUMS">SHA256 checksums</a></li>
		</ul>
	</li>
</ul>

### Installation

1. Clone the repo
	```sh
	git clone https://github.com/ocastaneda3/python-worm.git
	```

2. Download and Create Virtual Machines

	You can download the VirtualBox OVA files from [http://tech.ecs.fullerton.edu/cslabs/vms/](http://tech.ecs.fullerton.edu/cslabs/vms/). This link contains VirtualBox OVA's used by the Computer Science Department at California State University - Fullerton.
	
	```sh
	3x Lubuntu x86 VM(s)
	1x Windows XP VM(s)
	1x Endian324 VM(s)
	```

	MD5 Hashes
	```sh
	MD5 (lubuntux86.ova) = 0529bf910c525c6968f9315c3d2fc241
	MD5 (endian324.ova) = 23fefccc735a4a4a39ec343014e6e900
	MD5 (winxp-pro-sp2.ova) = [TO BE FILLED]
	```

3. Extract and Open GNS3 Project Files from `gns3_worm_files.zip`

<!-- USAGE EXAMPLES -->
## Usage

1. Copy `worm.py` into one of the three Lubuntu x86 VM's `/tmp/` folder

2. On host machine create host flag marker

	```sh
	touch /home/cpsc/host_system.txt
	```
	
	<p align="center">
		<img src="https://github.com/ocastaneda3/python-worm/blob/main/images/host_system_file.PNG">
	</p>
	
	This files is used as a flag to identify a host machine and prevent `worm.py` from infecting it. It is not necessary to hand any data in the file as `worm.py` only looks to see the file `host_system.txt` exists.

3. Execute

	```sh
	python /tmp/worm.py
	```
	
	<p align="center">
		<img src="https://github.com/ocastaneda3/python-worm/blob/main/images/infect_example.PNG">
	</p>
	
	Once `worm.py` is executed it will run through a list of avaliable hosts one at a time and compy itself into that systems `/tmp/` folder. After which it then send an execute signal to start the propagation to other systems from the newly infected computer.
	
	*( If worm is not placed in `/tmp/` folder, it will still run and execute but the path from which the file is executed from is changed. )*
	
4. Clean

	```sh
	python /tmp/worm.py -c
	```
	or
	```sh
	python /tmp/worm.py --clean
	```
	
	<p align="center">
		<img src="https://github.com/ocastaneda3/python-worm/blob/main/images/clean_example.PNG">
	</p>
	
	Cleaning mode is enabled when `-c` or `--clean` are appened to the execution of the worm. This enables a flag to now purge all the systems on the network of the worm. This is done by using the same connect and spread attribues as the execute and infect feature, but instead `worm.py` sends out clean commands to all the systems and then deletes itself from the machine. The cleaning mode does not affect the host machine.
	
	*( If worm is not placed in `/tmp/` folder, it will still run and execute but the path from which the file is executed from is changed. )*

<!-- CONTACT -->
## Contact

Project Link: [https://github.com/ocastaneda3/python-worm](https://github.com/ocastaneda3/python-worm)

<!-- MARKDOWN LINKS & IMAGES -->
[contributors-shield]: https://img.shields.io/github/contributors/ocastaneda3/python-worm.svg?style=for-the-badge
[contributors-url]: https://github.com/ocastaneda3/python-worm/graphs/contributors
[forks-shield]: https://img.shields.io/github/forks/ocastaneda3/python-worm.svg?style=for-the-badge
[forks-url]: https://github.com/ocastaneda3/python-worm/network/members
[stars-shield]: https://img.shields.io/github/stars/ocastaneda3/python-worm.svg?style=for-the-badge
[stars-url]: https://github.com/ocastaneda3/python-worm/stargazers
[linkedin-shield]: https://img.shields.io/badge/-LinkedIn-black.svg?style=for-the-badge&logo=linkedin&colorB=555
[linkedin-url]: https://linkedin.com/in/oscar-castaneda93
[single-network]: images/single_network.PNG
[multi-network]: images/multiple_networks.PNG
[gns3]: images/gns3_windows.png
